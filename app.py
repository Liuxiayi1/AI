import streamlit as st
import pandas as pd
import os
import matplotlib.pyplot as plt
import seaborn as sns

# 全局配置matplotlib中文字体，解决中文乱码问题
plt.rcParams['font.sans-serif'] = ['SimHei', 'Arial Unicode MS', 'DejaVu Sans']  # 多字体备份
plt.rcParams['axes.unicode_minus'] = False  # 解决负号显示问题

# 设置页面标题和说明
st.set_page_config(page_title='企业数字化转型指数查询系统', layout='wide', initial_sidebar_state='expanded')

# 自定义CSS样式
st.markdown("""
<style>
    .main-header {
        font-size: 2.5rem;
        color: #2c3e50;
        font-weight: bold;
        text-align: center;
        margin-bottom: 1rem;
    }
    .sub-header {
        font-size: 1.2rem;
        color: #7f8c8d;
        text-align: center;
        margin-bottom: 2rem;
    }
    .result-card {
        background-color: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }
    .metric-value {
        font-size: 64px;
        font-weight: bold;
        color: #3498db;
        text-align: center;
    }
    .metric-label {
        font-size: 18px;
        color: #7f8c8d;
        text-align: center;
    }
    .sidebar-title {
        font-size: 1.5rem;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 1rem;
    }
    .sidebar-subtitle {
        font-size: 1rem;
        color: #7f8c8d;
        margin-bottom: 1.5rem;
    }
</style>
""", unsafe_allow_html=True)

# 主页面标题
st.markdown('<h1 class="main-header">📊 企业数字化转型指数查询系统</h1>', unsafe_allow_html=True)
st.markdown('<p class="sub-header">本系统基于1999-2023年的数据，支持通过股票代码和企业名称查询数字化转型指数</p>', unsafe_allow_html=True)

# 创建模拟数据
try:
    # 创建模拟的数字化转型指数数据
    mock_jgb_data = [
        # 平安银行数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2000, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2001, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2002, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2003, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2004, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 4, '总词频数': 4},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2005, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 6, '总词频数': 6},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2006, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 8, '总词频数': 8},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2007, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 10, '总词频数': 10},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2008, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 13, '总词频数': 13},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2009, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 16, '总词频数': 16},
        # 2010-2023年数据
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2010, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 19, '总词频数': 19},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2011, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 2, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 21, '总词频数': 23},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2012, '数字化转型指数(0-100分)': 5, '人工智能词频数': 0, '大数据词频数': 5, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 24, '总词频数': 29},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2013, '数字化转型指数(0-100分)': 8, '人工智能词频数': 2, '大数据词频数': 8, '云计算词频数': 3, '区块链词频数': 0, '数字技术运用词频数': 28, '总词频数': 41},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2014, '数字化转型指数(0-100分)': 12, '人工智能词频数': 5, '大数据词频数': 15, '云计算词频数': 8, '区块链词频数': 2, '数字技术运用词频数': 35, '总词频数': 65},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2015, '数字化转型指数(0-100分)': 18, '人工智能词频数': 12, '大数据词频数': 28, '云计算词频数': 15, '区块链词频数': 8, '数字技术运用词频数': 45, '总词频数': 108},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2016, '数字化转型指数(0-100分)': 25, '人工智能词频数': 20, '大数据词频数': 42, '云计算词频数': 25, '区块链词频数': 15, '数字技术运用词频数': 60, '总词频数': 162},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2017, '数字化转型指数(0-100分)': 33, '人工智能词频数': 35, '大数据词频数': 60, '云计算词频数': 40, '区块链词频数': 28, '数字技术运用词频数': 80, '总词频数': 243},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2018, '数字化转型指数(0-100分)': 42, '人工智能词频数': 55, '大数据词频数': 85, '云计算词频数': 60, '区块链词频数': 45, '数字技术运用词频数': 105, '总词频数': 350},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2019, '数字化转型指数(0-100分)': 52, '人工智能词频数': 80, '大数据词频数': 115, '云计算词频数': 85, '区块链词频数': 65, '数字技术运用词频数': 135, '总词频数': 480},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2020, '数字化转型指数(0-100分)': 62, '人工智能词频数': 110, '大数据词频数': 150, '云计算词频数': 115, '区块链词频数': 85, '数字技术运用词频数': 170, '总词频数': 630},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2021, '数字化转型指数(0-100分)': 70, '人工智能词频数': 145, '大数据词频数': 190, '云计算词频数': 150, '区块链词频数': 110, '数字技术运用词频数': 210, '总词频数': 805},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2022, '数字化转型指数(0-100分)': 78, '人工智能词频数': 185, '大数据词频数': 235, '云计算词频数': 185, '区块链词频数': 140, '数字技术运用词频数': 255, '总词频数': 1000},
        {'股票代码': '000001', '企业名称': '平安银行', '年份': 2023, '数字化转型指数(0-100分)': 85, '人工智能词频数': 230, '大数据词频数': 285, '云计算词频数': 225, '区块链词频数': 175, '数字技术运用词频数': 305, '总词频数': 1220},
        
        # 万科A数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2000, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2001, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2002, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2003, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2004, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2005, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2006, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2007, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2008, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 4, '总词频数': 4},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2009, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 4, '总词频数': 4},
        # 2010-2023年数据
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2010, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 5, '总词频数': 5},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2011, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 1, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 7, '总词频数': 8},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2012, '数字化转型指数(0-100分)': 3, '人工智能词频数': 1, '大数据词频数': 2, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 10, '总词频数': 14},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2013, '数字化转型指数(0-100分)': 5, '人工智能词频数': 2, '大数据词频数': 4, '云计算词频数': 2, '区块链词频数': 0, '数字技术运用词频数': 15, '总词频数': 23},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2014, '数字化转型指数(0-100分)': 8, '人工智能词频数': 4, '大数据词频数': 7, '云计算词频数': 5, '区块链词频数': 1, '数字技术运用词频数': 22, '总词频数': 39},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2015, '数字化转型指数(0-100分)': 12, '人工智能词频数': 8, '大数据词频数': 12, '云计算词频数': 9, '区块链词频数': 3, '数字技术运用词频数': 32, '总词频数': 64},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2016, '数字化转型指数(0-100分)': 18, '人工智能词频数': 15, '大数据词频数': 20, '云计算词频数': 16, '区块链词频数': 6, '数字技术运用词频数': 45, '总词频数': 102},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2017, '数字化转型指数(0-100分)': 25, '人工智能词频数': 25, '大数据词频数': 32, '云计算词频数': 25, '区块链词频数': 12, '数字技术运用词频数': 62, '总词频数': 156},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2018, '数字化转型指数(0-100分)': 33, '人工智能词频数': 38, '大数据词频数': 48, '云计算词频数': 38, '区块链词频数': 20, '数字技术运用词频数': 85, '总词频数': 229},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2019, '数字化转型指数(0-100分)': 42, '人工智能词频数': 55, '大数据词频数': 68, '云计算词频数': 55, '区块链词频数': 32, '数字技术运用词频数': 115, '总词频数': 325},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2020, '数字化转型指数(0-100分)': 52, '人工智能词频数': 75, '大数据词频数': 92, '云计算词频数': 75, '区块链词频数': 48, '数字技术运用词频数': 150, '总词频数': 440},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2021, '数字化转型指数(0-100分)': 61, '人工智能词频数': 98, '大数据词频数': 120, '云计算词频数': 98, '区块链词频数': 65, '数字技术运用词频数': 190, '总词频数': 571},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2022, '数字化转型指数(0-100分)': 69, '人工智能词频数': 125, '大数据词频数': 152, '云计算词频数': 125, '区块链词频数': 85, '数字技术运用词频数': 235, '总词频数': 722},
        {'股票代码': '000002', '企业名称': '万科A', '年份': 2023, '数字化转型指数(0-100分)': 77, '人工智能词频数': 155, '大数据词频数': 188, '云计算词频数': 155, '区块链词频数': 108, '数字技术运用词频数': 285, '总词频数': 891},
        
        # 传化智联数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2000, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2001, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2002, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2003, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2004, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 4, '总词频数': 4},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2005, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 5, '总词频数': 5},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2006, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 6, '总词频数': 6},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2007, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 7, '总词频数': 7},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2008, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 8, '总词频数': 8},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2009, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 9, '总词频数': 9},
        # 2010-2023年数据
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2010, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 10, '总词频数': 10},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2011, '数字化转型指数(0-100分)': 5, '人工智能词频数': 1, '大数据词频数': 1, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 15, '总词频数': 17},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2012, '数字化转型指数(0-100分)': 8, '人工智能词频数': 2, '大数据词频数': 3, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 22, '总词频数': 28},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2013, '数字化转型指数(0-100分)': 12, '人工智能词频数': 4, '大数据词频数': 6, '云计算词频数': 3, '区块链词频数': 1, '数字技术运用词频数': 30, '总词频数': 44},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2014, '数字化转型指数(0-100分)': 17, '人工智能词频数': 7, '大数据词频数': 10, '云计算词频数': 6, '区块链词频数': 2, '数字技术运用词频数': 40, '总词频数': 65},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2015, '数字化转型指数(0-100分)': 24, '人工智能词频数': 12, '大数据词频数': 18, '云计算词频数': 12, '区块链词频数': 5, '数字技术运用词频数': 55, '总词频数': 102},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2016, '数字化转型指数(0-100分)': 32, '人工智能词频数': 20, '大数据词频数': 28, '云计算词频数': 20, '区块链词频数': 10, '数字技术运用词频数': 75, '总词频数': 153},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2017, '数字化转型指数(0-100分)': 40, '人工智能词频数': 32, '大数据词频数': 42, '云计算词频数': 32, '区块链词频数': 18, '数字技术运用词频数': 100, '总词频数': 224},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2018, '数字化转型指数(0-100分)': 49, '人工智能词频数': 48, '大数据词频数': 60, '云计算词频数': 48, '区块链词频数': 28, '数字技术运用词频数': 130, '总词频数': 314},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2019, '数字化转型指数(0-100分)': 58, '人工智能词频数': 68, '大数据词频数': 82, '云计算词频数': 68, '区块链词频数': 42, '数字技术运用词频数': 165, '总词频数': 425},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2020, '数字化转型指数(0-100分)': 67, '人工智能词频数': 92, '大数据词频数': 108, '云计算词频数': 92, '区块链词频数': 58, '数字技术运用词频数': 205, '总词频数': 555},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2021, '数字化转型指数(0-100分)': 74, '人工智能词频数': 120, '大数据词频数': 140, '云计算词频数': 120, '区块链词频数': 78, '数字技术运用词频数': 250, '总词频数': 708},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2022, '数字化转型指数(0-100分)': 81, '人工智能词频数': 152, '大数据词频数': 175, '云计算词频数': 152, '区块链词频数': 102, '数字技术运用词频数': 300, '总词频数': 881},
        {'股票代码': '002010', '企业名称': '传化智联', '年份': 2023, '数字化转型指数(0-100分)': 87, '人工智能词频数': 188, '大数据词频数': 215, '云计算词频数': 188, '区块链词频数': 130, '数字技术运用词频数': 355, '总词频数': 1076},
        
        # 京新药业数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2000, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2001, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2002, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2003, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2004, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2005, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 4, '总词频数': 4},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2006, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 5, '总词频数': 5},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2007, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 6, '总词频数': 6},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2008, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 7, '总词频数': 7},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2009, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 7, '总词频数': 7},
        # 2010-2023年数据
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2010, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 8, '总词频数': 8},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2011, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 1, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 12, '总词频数': 13},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2012, '数字化转型指数(0-100分)': 5, '人工智能词频数': 1, '大数据词频数': 2, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 16, '总词频数': 20},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2013, '数字化转型指数(0-100分)': 8, '人工智能词频数': 2, '大数据词频数': 4, '云计算词频数': 2, '区块链词频数': 1, '数字技术运用词频数': 22, '总词频数': 31},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2014, '数字化转型指数(0-100分)': 12, '人工智能词频数': 4, '大数据词频数': 7, '云计算词频数': 4, '区块链词频数': 2, '数字技术运用词频数': 30, '总词频数': 47},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2015, '数字化转型指数(0-100分)': 17, '人工智能词频数': 7, '大数据词频数': 12, '云计算词频数': 7, '区块链词频数': 4, '数字技术运用词频数': 40, '总词频数': 70},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2016, '数字化转型指数(0-100分)': 23, '人工智能词频数': 12, '大数据词频数': 18, '云计算词频数': 12, '区块链词频数': 7, '数字技术运用词频数': 55, '总词频数': 104},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2017, '数字化转型指数(0-100分)': 30, '人工智能词频数': 18, '大数据词频数': 27, '云计算词频数': 18, '区块链词频数': 12, '数字技术运用词频数': 72, '总词频数': 147},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2018, '数字化转型指数(0-100分)': 38, '人工智能词频数': 26, '大数据词频数': 38, '云计算词频数': 26, '区块链词频数': 18, '数字技术运用词频数': 95, '总词频数': 203},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2019, '数字化转型指数(0-100分)': 46, '人工智能词频数': 36, '大数据词频数': 52, '云计算词频数': 36, '区块链词频数': 27, '数字技术运用词频数': 125, '总词频数': 276},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2020, '数字化转型指数(0-100分)': 54, '人工智能词频数': 48, '大数据词频数': 68, '云计算词频数': 48, '区块链词频数': 38, '数字技术运用词频数': 160, '总词频数': 362},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2021, '数字化转型指数(0-100分)': 62, '人工智能词频数': 62, '大数据词频数': 86, '云计算词频数': 62, '区块链词频数': 52, '数字技术运用词频数': 200, '总词频数': 462},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2022, '数字化转型指数(0-100分)': 70, '人工智能词频数': 78, '大数据词频数': 106, '云计算词频数': 78, '区块链词频数': 68, '数字技术运用词频数': 245, '总词频数': 575},
        {'股票代码': '002020', '企业名称': '京新药业', '年份': 2023, '数字化转型指数(0-100分)': 77, '人工智能词频数': 96, '大数据词频数': 128, '云计算词频数': 96, '区块链词频数': 86, '数字技术运用词频数': 295, '总词频数': 701},
        
        # 招商银行数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2000, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2001, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2002, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 4, '总词频数': 4},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2003, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 6, '总词频数': 6},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2004, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 8, '总词频数': 8},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2005, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 10, '总词频数': 10},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2006, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 13, '总词频数': 13},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2007, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 15, '总词频数': 15},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2008, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 17, '总词频数': 17},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2009, '数字化转型指数(0-100分)': 4, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 19, '总词频数': 19},
        # 2010-2023年数据
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2010, '数字化转型指数(0-100分)': 4, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 20, '总词频数': 20},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2011, '数字化转型指数(0-100分)': 6, '人工智能词频数': 1, '大数据词频数': 2, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 25, '总词频数': 28},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2012, '数字化转型指数(0-100分)': 9, '人工智能词频数': 2, '大数据词频数': 4, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 32, '总词频数': 39},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2013, '数字化转型指数(0-100分)': 14, '人工智能词频数': 5, '大数据词频数': 8, '云计算词频数': 3, '区块链词频数': 1, '数字技术运用词频数': 42, '总词频数': 59},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2014, '数字化转型指数(0-100分)': 20, '人工智能词频数': 10, '大数据词频数': 15, '云计算词频数': 7, '区块链词频数': 3, '数字技术运用词频数': 55, '总词频数': 90},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2015, '数字化转型指数(0-100分)': 28, '人工智能词频数': 18, '大数据词频数': 28, '云计算词频数': 14, '区块链词频数': 7, '数字技术运用词频数': 72, '总词频数': 139},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2016, '数字化转型指数(0-100分)': 37, '人工智能词频数': 28, '大数据词频数': 45, '云计算词频数': 22, '区块链词频数': 14, '数字技术运用词频数': 95, '总词频数': 204},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2017, '数字化转型指数(0-100分)': 47, '人工智能词频数': 42, '大数据词频数': 65, '云计算词频数': 35, '区块链词频数': 24, '数字技术运用词频数': 125, '总词频数': 291},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2018, '数字化转型指数(0-100分)': 57, '人工智能词频数': 60, '大数据词频数': 90, '云计算词频数': 52, '区块链词频数': 38, '数字技术运用词频数': 160, '总词频数': 400},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2019, '数字化转型指数(0-100分)': 66, '人工智能词频数': 85, '大数据词频数': 120, '云计算词频数': 75, '区块链词频数': 55, '数字技术运用词频数': 205, '总词频数': 540},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2020, '数字化转型指数(0-100分)': 74, '人工智能词频数': 115, '大数据词频数': 155, '云计算词频数': 105, '区块链词频数': 75, '数字技术运用词频数': 255, '总词频数': 705},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2021, '数字化转型指数(0-100分)': 80, '人工智能词频数': 150, '大数据词频数': 195, '云计算词频数': 140, '区块链词频数': 98, '数字技术运用词频数': 310, '总词频数': 893},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2022, '数字化转型指数(0-100分)': 86, '人工智能词频数': 190, '大数据词频数': 240, '云计算词频数': 178, '区块链词频数': 125, '数字技术运用词频数': 370, '总词频数': 1103},
        {'股票代码': '600036', '企业名称': '招商银行', '年份': 2023, '数字化转型指数(0-100分)': 91, '人工智能词频数': 235, '大数据词频数': 290, '云计算词频数': 220, '区块链词频数': 155, '数字技术运用词频数': 435, '总词频数': 1335},
        
        # 贵州茅台数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2000, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2001, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2002, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 0, '总词频数': 0},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2003, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2004, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2005, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2006, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 1, '总词频数': 1},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2007, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2008, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 2, '总词频数': 2},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2009, '数字化转型指数(0-100分)': 0, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        # 2010-2023年数据
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2010, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2011, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 5, '总词频数': 5},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2012, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 1, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 8, '总词频数': 9},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2013, '数字化转型指数(0-100分)': 5, '人工智能词频数': 1, '大数据词频数': 2, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 12, '总词频数': 16},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2014, '数字化转型指数(0-100分)': 8, '人工智能词频数': 2, '大数据词频数': 4, '云计算词频数': 2, '区块链词频数': 1, '数字技术运用词频数': 18, '总词频数': 27},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2015, '数字化转型指数(0-100分)': 12, '人工智能词频数': 4, '大数据词频数': 7, '云计算词频数': 4, '区块链词频数': 2, '数字技术运用词频数': 25, '总词频数': 42},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2016, '数字化转型指数(0-100分)': 17, '人工智能词频数': 7, '大数据词频数': 12, '云计算词频数': 7, '区块链词频数': 4, '数字技术运用词频数': 35, '总词频数': 65},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2017, '数字化转型指数(0-100分)': 23, '人工智能词频数': 12, '大数据词频数': 18, '云计算词频数': 12, '区块链词频数': 7, '数字技术运用词频数': 48, '总词频数': 97},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2018, '数字化转型指数(0-100分)': 30, '人工智能词频数': 18, '大数据词频数': 27, '云计算词频数': 18, '区块链词频数': 12, '数字技术运用词频数': 65, '总词频数': 140},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2019, '数字化转型指数(0-100分)': 38, '人工智能词频数': 27, '大数据词频数': 38, '云计算词频数': 27, '区块链词频数': 18, '数字技术运用词频数': 85, '总词频数': 195},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2020, '数字化转型指数(0-100分)': 46, '人工智能词频数': 38, '大数据词频数': 52, '云计算词频数': 38, '区块链词频数': 27, '数字技术运用词频数': 110, '总词频数': 265},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2021, '数字化转型指数(0-100分)': 54, '人工智能词频数': 52, '大数据词频数': 68, '云计算词频数': 52, '区块链词频数': 38, '数字技术运用词频数': 140, '总词频数': 350},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2022, '数字化转型指数(0-100分)': 62, '人工智能词频数': 68, '大数据词频数': 88, '云计算词频数': 68, '区块链词频数': 52, '数字技术运用词频数': 175, '总词频数': 451},
        {'股票代码': '600519', '企业名称': '贵州茅台', '年份': 2023, '数字化转型指数(0-100分)': 70, '人工智能词频数': 85, '大数据词频数': 110, '云计算词频数': 85, '区块链词频数': 68, '数字技术运用词频数': 215, '总词频数': 563},
        
        # 阿里巴巴数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2000, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 5, '总词频数': 5},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2001, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 1, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 7, '总词频数': 8},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2002, '数字化转型指数(0-100分)': 4, '人工智能词频数': 0, '大数据词频数': 2, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 10, '总词频数': 13},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2003, '数字化转型指数(0-100分)': 5, '人工智能词频数': 1, '大数据词频数': 3, '云计算词频数': 2, '区块链词频数': 0, '数字技术运用词频数': 15, '总词频数': 21},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2004, '数字化转型指数(0-100分)': 7, '人工智能词频数': 1, '大数据词频数': 4, '云计算词频数': 3, '区块链词频数': 0, '数字技术运用词频数': 22, '总词频数': 30},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2005, '数字化转型指数(0-100分)': 9, '人工智能词频数': 2, '大数据词频数': 6, '云计算词频数': 4, '区块链词频数': 0, '数字技术运用词频数': 30, '总词频数': 42},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2006, '数字化转型指数(0-100分)': 11, '人工智能词频数': 3, '大数据词频数': 7, '云计算词频数': 5, '区块链词频数': 0, '数字技术运用词频数': 38, '总词频数': 53},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2007, '数字化转型指数(0-100分)': 12, '人工智能词频数': 4, '大数据词频数': 8, '云计算词频数': 6, '区块链词频数': 0, '数字技术运用词频数': 43, '总词频数': 61},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2008, '数字化转型指数(0-100分)': 13, '人工智能词频数': 4, '大数据词频数': 9, '云计算词频数': 7, '区块链词频数': 0, '数字技术运用词频数': 47, '总词频数': 67},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2009, '数字化转型指数(0-100分)': 14, '人工智能词频数': 5, '大数据词频数': 10, '云计算词频数': 8, '区块链词频数': 0, '数字技术运用词频数': 50, '总词频数': 73},
        # 2010-2023年数据
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2010, '数字化转型指数(0-100分)': 15, '人工智能词频数': 5, '大数据词频数': 10, '云计算词频数': 8, '区块链词频数': 0, '数字技术运用词频数': 50, '总词频数': 73},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2011, '数字化转型指数(0-100分)': 22, '人工智能词频数': 10, '大数据词频数': 18, '云计算词频数': 15, '区块链词频数': 1, '数字技术运用词频数': 70, '总词频数': 114},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2012, '数字化转型指数(0-100分)': 30, '人工智能词频数': 18, '大数据词频数': 30, '云计算词频数': 25, '区块链词频数': 2, '数字技术运用词频数': 95, '总词频数': 170},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2013, '数字化转型指数(0-100分)': 38, '人工智能词频数': 28, '大数据词频数': 45, '云计算词频数': 40, '区块链词频数': 4, '数字技术运用词频数': 125, '总词频数': 242},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2014, '数字化转型指数(0-100分)': 47, '人工智能词频数': 40, '大数据词频数': 65, '云计算词频数': 60, '区块链词频数': 8, '数字技术运用词频数': 160, '总词频数': 333},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2015, '数字化转型指数(0-100分)': 56, '人工智能词频数': 55, '大数据词频数': 90, '云计算词频数': 85, '区块链词频数': 15, '数字技术运用词频数': 200, '总词频数': 445},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2016, '数字化转型指数(0-100分)': 64, '人工智能词频数': 75, '大数据词频数': 120, '云计算词频数': 115, '区块链词频数': 25, '数字技术运用词频数': 245, '总词频数': 580},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2017, '数字化转型指数(0-100分)': 72, '人工智能词频数': 100, '大数据词频数': 155, '云计算词频数': 150, '区块链词频数': 40, '数字技术运用词频数': 295, '总词频数': 740},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2018, '数字化转型指数(0-100分)': 78, '人工智能词频数': 130, '大数据词频数': 195, '云计算词频数': 190, '区块链词频数': 60, '数字技术运用词频数': 350, '总词频数': 925},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2019, '数字化转型指数(0-100分)': 83, '人工智能词频数': 165, '大数据词频数': 240, '云计算词频数': 235, '区块链词频数': 85, '数字技术运用词频数': 410, '总词频数': 1135},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2020, '数字化转型指数(0-100分)': 87, '人工智能词频数': 205, '大数据词频数': 290, '云计算词频数': 285, '区块链词频数': 115, '数字技术运用词频数': 475, '总词频数': 1370},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2021, '数字化转型指数(0-100分)': 90, '人工智能词频数': 250, '大数据词频数': 345, '云计算词频数': 340, '区块链词频数': 150, '数字技术运用词频数': 545, '总词频数': 1630},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2022, '数字化转型指数(0-100分)': 92, '人工智能词频数': 300, '大数据词频数': 405, '云计算词频数': 395, '区块链词频数': 190, '数字技术运用词频数': 620, '总词频数': 1910},
        {'股票代码': 'BABA', '企业名称': '阿里巴巴', '年份': 2023, '数字化转型指数(0-100分)': 94, '人工智能词频数': 355, '大数据词频数': 470, '云计算词频数': 455, '区块链词频数': 235, '数字技术运用词频数': 700, '总词频数': 2215},
        
        # 腾讯控股数据（2000-2023）
        # 2000-2009年数据
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2000, '数字化转型指数(0-100分)': 1, '人工智能词频数': 0, '大数据词频数': 0, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 3, '总词频数': 3},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2001, '数字化转型指数(0-100分)': 2, '人工智能词频数': 0, '大数据词频数': 1, '云计算词频数': 0, '区块链词频数': 0, '数字技术运用词频数': 5, '总词频数': 6},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2002, '数字化转型指数(0-100分)': 3, '人工智能词频数': 0, '大数据词频数': 1, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 8, '总词频数': 10},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2003, '数字化转型指数(0-100分)': 4, '人工智能词频数': 1, '大数据词频数': 2, '云计算词频数': 1, '区块链词频数': 0, '数字技术运用词频数': 12, '总词频数': 16},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2004, '数字化转型指数(0-100分)': 5, '人工智能词频数': 1, '大数据词频数': 3, '云计算词频数': 2, '区块链词频数': 0, '数字技术运用词频数': 18, '总词频数': 24},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2005, '数字化转型指数(0-100分)': 7, '人工智能词频数': 2, '大数据词频数': 4, '云计算词频数': 3, '区块链词频数': 0, '数字技术运用词频数': 25, '总词频数': 34},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2006, '数字化转型指数(0-100分)': 8, '人工智能词频数': 2, '大数据词频数': 5, '云计算词频数': 3, '区块链词频数': 0, '数字技术运用词频数': 30, '总词频数': 40},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2007, '数字化转型指数(0-100分)': 9, '人工智能词频数': 2, '大数据词频数': 6, '云计算词频数': 4, '区块链词频数': 0, '数字技术运用词频数': 35, '总词频数': 47},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2008, '数字化转型指数(0-100分)': 10, '人工智能词频数': 3, '大数据词频数': 7, '云计算词频数': 4, '区块链词频数': 0, '数字技术运用词频数': 38, '总词频数': 52},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2009, '数字化转型指数(0-100分)': 11, '人工智能词频数': 3, '大数据词频数': 8, '云计算词频数': 5, '区块链词频数': 0, '数字技术运用词频数': 39, '总词频数': 55},
        # 2010-2023年数据
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2010, '数字化转型指数(0-100分)': 12, '人工智能词频数': 3, '大数据词频数': 8, '云计算词频数': 5, '区块链词频数': 0, '数字技术运用词频数': 40, '总词频数': 56},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2011, '数字化转型指数(0-100分)': 19, '人工智能词频数': 7, '大数据词频数': 15, '云计算词频数': 12, '区块链词频数': 1, '数字技术运用词频数': 58, '总词频数': 93},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2012, '数字化转型指数(0-100分)': 27, '人工智能词频数': 13, '大数据词频数': 25, '云计算词频数': 20, '区块链词频数': 2, '数字技术运用词频数': 80, '总词频数': 140},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2013, '数字化转型指数(0-100分)': 35, '人工智能词频数': 22, '大数据词频数': 38, '云计算词频数': 32, '区块链词频数': 3, '数字技术运用词频数': 108, '总词频数': 203},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2014, '数字化转型指数(0-100分)': 44, '人工智能词频数': 33, '大数据词频数': 55, '云计算词频数': 48, '区块链词频数': 7, '数字技术运用词频数': 142, '总词频数': 285},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2015, '数字化转型指数(0-100分)': 53, '人工智能词频数': 48, '大数据词频数': 75, '云计算词频数': 68, '区块链词频数': 12, '数字技术运用词频数': 182, '总词频数': 385},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2016, '数字化转型指数(0-100分)': 62, '人工智能词频数': 65, '大数据词频数': 100, '云计算词频数': 95, '区块链词频数': 20, '数字技术运用词频数': 228, '总词频数': 508},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2017, '数字化转型指数(0-100分)': 70, '人工智能词频数': 88, '大数据词频数': 130, '云计算词频数': 130, '区块链词频数': 32, '数字技术运用词频数': 280, '总词频数': 660},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2018, '数字化转型指数(0-100分)': 77, '人工智能词频数': 115, '大数据词频数': 165, '云计算词频数': 170, '区块链词频数': 48, '数字技术运用词频数': 340, '总词频数': 838},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2019, '数字化转型指数(0-100分)': 82, '人工智能词频数': 150, '大数据词频数': 205, '云计算词频数': 215, '区块链词频数': 68, '数字技术运用词频数': 405, '总词频数': 1043},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2020, '数字化转型指数(0-100分)': 86, '人工智能词频数': 190, '大数据词频数': 250, '云计算词频数': 265, '区块链词频数': 92, '数字技术运用词频数': 475, '总词频数': 1272},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2021, '数字化转型指数(0-100分)': 89, '人工智能词频数': 235, '大数据词频数': 300, '云计算词频数': 320, '区块链词频数': 120, '数字技术运用词频数': 550, '总词频数': 1525},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2022, '数字化转型指数(0-100分)': 91, '人工智能词频数': 285, '大数据词频数': 355, '云计算词频数': 375, '区块链词频数': 155, '数字技术运用词频数': 630, '总词频数': 1790},
        {'股票代码': '0700.HK', '企业名称': '腾讯控股', '年份': 2023, '数字化转型指数(0-100分)': 93, '人工智能词频数': 340, '大数据词频数': 415, '云计算词频数': 435, '区块链词频数': 195, '数字技术运用词频数': 715, '总词频数': 2090}
    ]
    
    # 创建jgb_df数据框
    jgb_df = pd.DataFrame(mock_jgb_data)
    jgb_df['股票代码'] = jgb_df['股票代码'].astype(str)
    
    # 创建模拟的技术关键词统计数据（gjc_df）
    mock_gjc_data = []
    for row in mock_jgb_data:
        gjc_row = {
            '股票代码': row['股票代码'],
            '企业名称': row['企业名称'], 
            '年份': row['年份'],
            '人工智能词频数': row['人工智能词频数'],
            '大数据词频数': row['大数据词频数'],
            '云计算词频数': row['云计算词频数'],
            '区块链词频数': row['区块链词频数'],
            '数字技术运用词频数': row['数字技术运用词频数']
        }
        mock_gjc_data.append(gjc_row)
    
    # 创建gjc_df数据框
    gjc_df = pd.DataFrame(mock_gjc_data)
    gjc_df['股票代码'] = gjc_df['股票代码'].astype(str)
    

    
except Exception as e:
    st.error(f'数据加载出错: {str(e)}')
    st.stop()

# 获取所有股票代码列表
stock_codes = jgb_df['股票代码'].unique().tolist()
stock_codes.sort()  # 排序以便用户查找

# 获取所有企业名称列表
company_names = jgb_df['企业名称'].unique().tolist()
company_names.sort()  # 排序以便用户查找

# 获取所有年份列表
years = jgb_df['年份'].unique().tolist()
years.sort(reverse=True)  # 按降序排序，默认显示最近年份

# 创建侧边栏查询区域
st.sidebar.markdown('<h2 class="sidebar-title">🔍 查询条件</h2>', unsafe_allow_html=True)
st.sidebar.markdown('<p class="sidebar-subtitle">请输入或选择查询条件</p>', unsafe_allow_html=True)

# 将股票代码改为下拉选择框
selected_stock = st.sidebar.selectbox('股票代码', options=[''] + stock_codes, index=0)
selected_company = st.sidebar.selectbox('企业名称', options=[''] + company_names, index=0)
selected_year = st.sidebar.selectbox('年份', options=years)
search_button = st.sidebar.button('查询', type='primary', use_container_width=True)

# 添加分隔线
st.sidebar.markdown('---')

# 显示数据概览在侧边栏
st.sidebar.markdown('<h3>📊 数据概览</h3>', unsafe_allow_html=True)
st.sidebar.write(f'年份范围：{min(years)}-{max(years)}')
st.sidebar.write(f'企业数量：{len(company_names)}家')

# 查询逻辑
if search_button:
    if not selected_stock and not selected_company:
        st.warning('请至少输入股票代码或选择企业名称')
    else:
        # 构建查询条件
        query = jgb_df['年份'] == selected_year
        if selected_stock:
            query &= jgb_df['股票代码'] == selected_stock
        if selected_company:
            query &= jgb_df['企业名称'] == selected_company
        
        result = jgb_df[query]
        
        if result.empty:
            st.warning('未找到符合条件的数据')
        else:
            st.markdown('---')
            st.subheader('📋 查询结果')
            
            # 添加数字化转型指数趋势折线图（放在最上面）
            with st.container():
                st.markdown('<div class="result-card">', unsafe_allow_html=True)
                st.markdown('### 📈 数字化转型指数趋势（2010-2023）')
                
                # 获取该企业所有年份的数据
                company_data = jgb_df[jgb_df['股票代码'] == result.iloc[0]['股票代码']]
                company_data_sorted = company_data.sort_values('年份')
                
                # 绘制趋势图
                # 使用全局配置的matplotlib字体
                
                fig, ax = plt.subplots(figsize=(16, 8), dpi=100)
                # 优化折线图样式
                sns.lineplot(data=company_data_sorted, x='年份', y='数字化转型指数(0-100分)', ax=ax, 
                            linewidth=4, marker='o', markersize=12, color='#2c3e50', 
                            markerfacecolor='#3498db', markeredgecolor='white', markeredgewidth=3)
                
                # 添加填充区域，使用渐变色效果
                ax.fill_between(company_data_sorted['年份'], company_data_sorted['数字化转型指数(0-100分)'], 
                              alpha=0.3, color='#3498db')
                
                # 设置标题和标签样式
                plt.title(f'{result.iloc[0]["企业名称"]} 数字化转型指数年度趋势', 
                         fontsize=22, fontweight='bold', color='#2c3e50', 
                         pad=20)
                plt.xlabel('年份', fontsize=16, fontweight='bold', labelpad=15)
                plt.ylabel('数字化转型指数(0-100分)', fontsize=16, fontweight='bold', labelpad=15)
                
                # 优化坐标轴样式
                plt.grid(True, alpha=0.4, linestyle='--', color='#bdc3c7')
                plt.xticks(company_data_sorted['年份'], rotation=45, fontsize=14)
                plt.yticks(fontsize=14)
                
                # 设置坐标轴范围
                plt.ylim(0, 105)  # 稍微扩大Y轴范围，为数据标签留出空间
                
                # 美化坐标轴
                ax.spines['top'].set_visible(False)
                ax.spines['right'].set_visible(False)
                ax.spines['left'].set_linewidth(2)
                ax.spines['bottom'].set_linewidth(2)
                
                # 添加数据标签，使用更好的位置和样式
                for i, value in enumerate(company_data_sorted['数字化转型指数(0-100分)']):
                    ax.text(company_data_sorted['年份'].iloc[i], value + 3, f'{value}', 
                           ha='center', fontsize=12, fontweight='bold', color='#2c3e50',
                           bbox=dict(boxstyle='round,pad=0.3', fc='white', ec='#3498db', lw=1, alpha=0.8))
                
                # 添加数据点注释
                max_value = company_data_sorted['数字化转型指数(0-100分)'].max()
                max_year = company_data_sorted[company_data_sorted['数字化转型指数(0-100分)'] == max_value]['年份'].values[0]
                ax.annotate(f'最高指数: {max_value}', 
                           xy=(max_year, max_value), 
                           xytext=(max_year, max_value + 10),
                           arrowprops=dict(facecolor='#e74c3c', shrink=0.05, width=2, headwidth=8),
                           fontsize=14, fontweight='bold', color='#e74c3c')
                
                plt.tight_layout()
                
                # 显示图表
                st.pyplot(fig)
                
                # 添加数据表格显示年度数据
                st.markdown('#### 年度数据详情')
                st.dataframe(company_data_sorted[['年份', '数字化转型指数(0-100分)', '人工智能词频数', '大数据词频数', '云计算词频数', '区块链词频数']], 
                           width='stretch', hide_index=True)
                
                st.markdown('</div>', unsafe_allow_html=True)
            
            # 使用卡片布局显示基本信息
            with st.container():
                st.markdown('<div class="result-card">', unsafe_allow_html=True)
                st.markdown('### 企业基本信息')
                col1, col2, col3 = st.columns(3)
                with col1:
                    st.metric(label='股票代码', value=result.iloc[0]['股票代码'])
                with col2:
                    st.metric(label='企业名称', value=result.iloc[0]['企业名称'])
                with col3:
                    st.metric(label='年份', value=result.iloc[0]['年份'])
                st.markdown('</div>', unsafe_allow_html=True)
            
            # 使用更大的字体显示数字化转型指数
            with st.container():
                st.markdown('<div class="result-card">', unsafe_allow_html=True)
                st.markdown('### 数字化转型指数')
                st.markdown(f'<div class="metric-value">{result.iloc[0]["数字化转型指数(0-100分)"]}</div>', unsafe_allow_html=True)
                st.markdown('<div class="metric-label">(满分100分)</div>', unsafe_allow_html=True)
                st.markdown('</div>', unsafe_allow_html=True)
            
            # 显示详细技术词频数据
            with st.container():
                st.markdown('<div class="result-card">', unsafe_allow_html=True)
                st.markdown('### 技术词频统计')
                tech_columns = ['人工智能词频数', '大数据词频数', '云计算词频数', '区块链词频数', '数字技术运用词频数']
                
                # 使用两列布局显示技术词频
                cols = st.columns(2)
                for i, col in enumerate(tech_columns):
                    with cols[i % 2]:
                        st.metric(label=col, value=result.iloc[0][col])
                st.markdown('</div>', unsafe_allow_html=True)



