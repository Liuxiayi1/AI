# Pythonå®æˆ˜ï¼šç”¨Streamlitæ‰“é€ PDFè¡¨æ ¼ä¸å›¾ç‰‡æå–ç¥å™¨

åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä» PDF æ–‡æ¡£ä¸­æå–æ•°æ®æˆ–ç´ æã€‚æ‰‹åŠ¨å¤åˆ¶ç²˜è´´ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Python å’Œ Streamlit å¿«é€Ÿæ­å»ºä¸€ä¸ªå¯è§†åŒ–çš„ PDF å¤„ç†å·¥å…·ï¼Œå®ç°è‡ªåŠ¨æå–è¡¨æ ¼ï¼ˆå¹¶å¯¼å‡ºä¸º Excelï¼‰å’Œå›¾ç‰‡çš„åŠŸèƒ½ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªæŠ€æœ¯æ ˆï¼Ÿ

*   **Streamlit**: æ— éœ€å‰ç«¯çŸ¥è¯†ï¼Œç”¨çº¯ Python å°±èƒ½å†™å‡ºæ¼‚äº®çš„ Web ç•Œé¢ï¼Œéå¸¸é€‚åˆå¿«é€Ÿå¼€å‘æ•°æ®å·¥å…·ã€‚
*   **pdfplumber**: ç›®å‰ Python ç”Ÿæ€ä¸­æå– PDF è¡¨æ ¼æ•ˆæœæœ€å¥½çš„åº“ä¹‹ä¸€ï¼Œèƒ½ç²¾ç¡®è¯†åˆ«è¡¨æ ¼è¾¹æ¡†ã€‚
*   **PyMuPDF (fitz)**: å¤„ç† PDF åº•å±‚ç»“æ„éå¸¸å¿«ï¼Œé€‚åˆç”¨æ¥æå–å›¾ç‰‡ã€‚
*   **Pandas**: æ•°æ®å¤„ç†çš„ç¥å™¨ï¼Œé…åˆ OpenPyXL å¯ä»¥è½»æ¾ç”Ÿæˆ Excel æ–‡ä»¶ã€‚

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ç¯å¢ƒæ­å»º

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å¿…è¦çš„åº“ã€‚åˆ›å»ºä¸€ä¸ª `requirements.txt` æ–‡ä»¶ï¼š

```txt
streamlit
pdfplumber
pandas
openpyxl
pymupdf
```

ç„¶åæ‰§è¡Œ `pip install -r requirements.txt`ã€‚

### 2. æ„å»º Streamlit ç•Œé¢

æˆ‘ä»¬åªéœ€è¦å‡ è¡Œä»£ç å°±èƒ½æ­å»ºå‡ºæ–‡ä»¶ä¸Šä¼ å’Œé€‰é¡¹å¡çš„ç•Œé¢ï¼š

```python
import streamlit as st

st.set_page_config(page_title="PDFå·¥å…·ç®±", layout="wide")
st.title("ğŸ“„ PDF è¡¨æ ¼ä¸å›¾ç‰‡æå–å·¥å…·")

uploaded_file = st.file_uploader("è¯·ä¸Šä¼  PDF æ–‡ä»¶", type=["pdf"])

if uploaded_file:
    tab1, tab2 = st.tabs(["ğŸ“Š è¡¨æ ¼æå–", "ğŸ–¼ï¸ å›¾ç‰‡æå–"])
    # åç»­é€»è¾‘å†™åœ¨è¿™é‡Œ
```

### 3. æå–è¡¨æ ¼å¹¶å¯¼å‡º Excel

ä½¿ç”¨ `pdfplumber` æ‰“å¼€ PDFï¼Œéå†æ¯ä¸€é¡µæŸ¥æ‰¾è¡¨æ ¼ã€‚ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä¸‹è½½ï¼Œæˆ‘ä»¬ä½¿ç”¨ `pandas` å°†è¡¨æ ¼æ•°æ®å†™å…¥ Excel çš„ä¸åŒ Sheet ä¸­ã€‚

**å…³é”®ä»£ç ç‰‡æ®µï¼š**

```python
import pdfplumber
import pandas as pd
import io

# ... åœ¨ tab1 ä¸­ ...
if st.button("å¼€å§‹æå–è¡¨æ ¼"):
    with pdfplumber.open(uploaded_file) as pdf:
        # åˆ›å»ºä¸€ä¸ª BytesIO å¯¹è±¡ç”¨äºåœ¨å†…å­˜ä¸­ä¿å­˜ Excel æ–‡ä»¶
        output = io.BytesIO()
        with pd.ExcelWriter(output, engine='openpyxl') as writer:
            for i, page in enumerate(pdf.pages):
                tables = page.extract_tables()
                for j, table in enumerate(tables):
                    df = pd.DataFrame(table[1:], columns=table[0])
                    # å†™å…¥ Excel
                    sheet_name = f"Page_{i+1}_Table_{j+1}"
                    df.to_excel(writer, sheet_name=sheet_name[:31], index=False)
        
        output.seek(0)
        st.download_button("ä¸‹è½½ Excel", output, "tables.xlsx")
```

### 4. æå–å›¾ç‰‡

å¯¹äºå›¾ç‰‡æå–ï¼Œ`PyMuPDF` (fitz) æ›´åŠ é«˜æ•ˆã€‚æˆ‘ä»¬éœ€è¦éå† PDF çš„å¯¹è±¡åˆ—è¡¨ï¼ˆXREFï¼‰ï¼Œæ‰¾åˆ°å›¾ç‰‡å¯¹è±¡å¹¶æå–å…¶äºŒè¿›åˆ¶æ•°æ®ã€‚

**å…³é”®ä»£ç ç‰‡æ®µï¼š**

```python
import fitz
from PIL import Image

# ... åœ¨ tab2 ä¸­ ...
if st.button("å¼€å§‹æå–å›¾ç‰‡"):
    # æ³¨æ„ï¼šStreamlit çš„ uploaded_file éœ€è¦è¯»å–ä¸º bytes ç»™ fitz ä½¿ç”¨
    doc = fitz.open(stream=uploaded_file.read(), filetype="pdf")
    
    for page in doc:
        image_list = page.get_images(full=True)
        for img in image_list:
            xref = img[0]
            base_image = doc.extract_image(xref)
            image_bytes = base_image["image"]
            
            # å±•ç¤ºå›¾ç‰‡
            st.image(image_bytes)
            # æä¾›ä¸‹è½½æŒ‰é’®
            st.download_button("ä¸‹è½½å›¾ç‰‡", image_bytes, file_name="image.png")
```

### 5. é‡åˆ°çš„å‘ä¸è§£å†³æ–¹æ¡ˆ

*   **æ–‡ä»¶æŒ‡é’ˆé—®é¢˜**: `uploaded_file` æ˜¯ä¸€ä¸ªæµå¯¹è±¡ã€‚å¦‚æœå…ˆè¢« `pdfplumber` è¯»å–äº†ï¼ŒæŒ‡é’ˆä¼šè·‘åˆ°æ–‡ä»¶æœ«å°¾ã€‚å†ä¼ ç»™ `fitz` æ—¶å°±ä¼šæŠ¥é”™ã€‚è§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ¯æ¬¡è¯»å–å‰è°ƒç”¨ `.seek(0)`ï¼Œæˆ–è€…ä¸€æ¬¡æ€§è¯»å–ä¸º `bytes` å¹¶åœ¨å†…å­˜ä¸­å¤ç”¨ã€‚
*   **Excel Sheet åç§°é™åˆ¶**: Excel çš„ Sheet åç§°ä¸èƒ½è¶…è¿‡ 31 ä¸ªå­—ç¬¦ï¼Œä¸”ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ã€‚åœ¨å†™å…¥æ—¶éœ€è¦åšæˆªæ–­å¤„ç†ã€‚
*   **æ‰«æç‰ˆ PDF**: å¯¹äºå…¨æ˜¯å›¾ç‰‡çš„æ‰«æç‰ˆ PDFï¼Œä¸Šè¿°æ–¹æ³•æ— æ³•æå–è¡¨æ ¼æ–‡å­—ã€‚è¿™ç§æƒ…å†µéœ€è¦å¼•å…¥ OCRï¼ˆå¦‚ PaddleOCRï¼‰ï¼Œä½†è¿™ä¼šæ˜¾è‘—å¢åŠ å¤æ‚åº¦å’Œè¿è¡Œæ—¶é—´ã€‚

## æ€»ç»“

é€šè¿‡ä¸åˆ° 100 è¡Œä»£ç ï¼Œæˆ‘ä»¬å°±æ„å»ºäº†ä¸€ä¸ªå®ç”¨çš„åŠå…¬è‡ªåŠ¨åŒ–å·¥å…·ã€‚Streamlit è®©æˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºæ ¸å¿ƒé€»è¾‘ï¼Œè€Œæ— éœ€çº ç»“äº HTML/CSS çš„ç»†èŠ‚ã€‚è¿™ä¸ªå·¥å…·å¯ä»¥è½»æ¾æ‰©å±•ï¼Œæ¯”å¦‚å¢åŠ  PDF åˆå¹¶ã€æ‹†åˆ†ã€è½¬ Word ç­‰åŠŸèƒ½ã€‚

---
*å¸Œæœ›è¿™ç¯‡æ•™ç¨‹å¯¹ä½ æœ‰å¸®åŠ©ï¼å®Œæ•´ä»£ç è¯·å‚è€ƒé¡¹ç›®ä»“åº“ã€‚*
